import{z as _,r as m,f as F,h,g as q,j as t,bO as M,bP as O}from"./index-B8WTsAS6.js";import{u as R}from"./index.esm-CH-ucXk-.js";import{Q as A}from"./react-toastify.esm-BnAFxftJ.js";/* empty css                      */import{a as g,n as L}from"./msgtoast-BPgOMtRW.js";import{R as V,b as z}from"./ReusableBreadcrumb-D5trGug1.js";import{u as B,a as K,F as U,b as w,I as $,C as Q}from"./formSelect-C9MCM6qV.js";import{f as W}from"./format-bLcKm-ZP.js";import"./clsx-B-dksMZM.js";import"./numericFormatWrapper-BQSre79J.js";import"./react-number-format.es-D6o-XRFQ.js";import"./ckeditor5-DyEy2vTb.js";import"./DeleteIcon-BukMQWWF.js";import"./chunk-TDOFO53L-BhVz0FjF.js";import"./chunk-N2KXC5ZE-mxrXGXiM.js";import"./chunk-3ZXLDIEA-b4fsncww.js";import"./useOverlayTriggerState-_gK5y_xw.js";import"./useFocusWithin-Cnv4cfRz.js";import"./useEffectEvent-Cg1JSw20.js";import"./number-DfkVkf0F.js";import"./FocusScope-DCO5JZf9.js";import"./focusSafely-7dc_zii7.js";import"./chunk-BZCSOIUI-ECjOxws-.js";import"./chunk-XHQUSKIE-BwnSvnTo.js";import"./filterDOMProps-B3AneKiX.js";import"./useHover-BojuH7IM.js";import"./useFocusable-BgsBLUcz.js";import"./useFocus-CiKVCmpT.js";import"./chunk-CIZQCQPA-BQKhqm3c.js";import"./index-DiNnCp_7.js";import"./features-animation-BrpZblPW.js";import"./chunk-5A5NBK2V-B8-r7H_u.js";import"./chunk-MNNRULGA-Ck-UmubQ.js";import"./index-D8A0NvNB.js";import"./useLabel-C_525Utu.js";import"./useLabels-C5NmhLsG.js";import"./constants-B1QkQIQl.js";const G=()=>{var b,y,v,j;const{categories:N,products:k}=B(),{id:o}=_(),{register:i,handleSubmit:E,control:P,watch:C,setValue:a,formState:{errors:n}}=R(),[l,r]=m.useState(!1),{imgPreview:D,setImgPreview:x,handleImageChange:I,error:d}=K(),p=F(),s=h(e=>e.post.getOnePost.post),f=h(e=>e.post.getOnePost.status),u=h(e=>e.post.getOnePost.error),S=q();m.useEffect(()=>{s&&s.thumbnail&&s.thumbnail.length>0&&x(s.thumbnail[0])},[s,x,a]),m.useEffect(()=>{if(!o){r(!1);return}(async()=>{r(!0);try{await p(M(o)).unwrap()}catch{g(u instanceof Error?u.message:"Lỗi hệ thống")}finally{r(!1)}})()},[o,p,u]),m.useEffect(()=>{if(f==="succeeded"&&s){const e=W(new Date(s.createdAt),"yyyy-MM-dd");a("title",s.title),a("createdAt",e),a("content",s.content),a("product",s.product._id),a("category",s.category._id)}},[f,s,a]);const T=async e=>{r(!0);try{if(d){g(d);return}const c=await p(O({postId:o,postData:e})).unwrap();L(c.msg),setTimeout(()=>{S("/admin/list-post")},2e3)}catch(c){g(c.msg)}finally{r(!1)}};return t.jsxs("form",{onSubmit:E(T),encType:"multipart/form-data",children:[t.jsx(A,{}),t.jsx(V,{items:z.addVariant}),t.jsx("div",{className:"flex items-center px-4 py-2",children:t.jsxs("h1",{className:"text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white",children:["Đang cập nhật bài viết cho "," ",t.jsx("span",{className:"text-blue-600",children:((b=s==null?void 0:s.product)==null?void 0:b.product_name)||"Không có sản phẩm"})]})}),t.jsx("div",{className:"grid grid-cols-1 px-4 pt-4 xl:grid-cols-2 xl:gap-4 dark:bg-gray-900",children:t.jsx("div",{className:"col-span-full xl:col-auto",children:t.jsxs("div",{className:"p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800",children:[t.jsx("h3",{className:"mb-4 text-xl font-semibold dark:text-white",children:"Tổng quan bài viết"}),t.jsxs("div",{className:"grid grid-cols-6 gap-6",children:[t.jsx("div",{className:"col-span-6 sm:col-span-6",children:t.jsx(U,{id:"title",label:"Tiêu đề bài viết",placeholder:"Nhập tiêu đề bài viết",register:i,control:P,error:n.title,validation:{required:"Tiêu đề là bắt buộc"}})}),t.jsx("div",{className:"col-span-3 1sm:col-span-3",children:t.jsx(w,{label:"Danh mục",id:"category",options:N.map(e=>({_id:e._id,name:e.name})),register:i,validation:{required:"Danh mục là bắt buộc"},errorMessage:(y=n.category)==null?void 0:y.message})}),t.jsx("div",{className:"col-span-3 1sm:col-span-3",children:t.jsx(w,{label:"Sản phẩm",id:"product",options:k.map(e=>({_id:e._id,name:e.product_name})),register:i,validation:{required:"Danh mục là bắt buộc"},errorMessage:(v=n.product)==null?void 0:v.message})}),t.jsx("div",{className:"col-span-6 sm:col-span-6",children:t.jsx($,{imgPreview:D,register:i,handleImageChange:I,error:d||((j=n.thumbnail)==null?void 0:j.message),validation:{required:"vui lòng chọn ảnh"}})}),t.jsx("div",{className:"col-span-6 1sm:col-span-3 mb-4",children:t.jsx(Q,{name:"content",value:C("content"),onChange:e=>a("content",e)})})]}),t.jsx("div",{className:"col-span-6 sm:col-full",children:t.jsx("button",{type:"submit",className:`text-white bg-blue-600 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 ${l?"opacity-50 cursor-not-allowed":""}`,disabled:l,children:l?t.jsxs("div",{className:"flex items-center",children:[t.jsxs("svg",{className:"animate-spin mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Đang thêm..."]}):"Thêm sản phẩm"})})]})})})]})},_t=()=>t.jsx(G,{});export{_t as default};
