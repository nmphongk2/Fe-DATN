import{j as e,f as N,h as y,r as p,M as z,N as J,P as G,Q as K,L as U,J as Y,g as ee,B as M,z as te,S as se,U as ae,V as ne}from"./index-B8WTsAS6.js";import{q as R,R as ie,b as re}from"./base-BeIOSPgb.js";import{W as P,C as S,F as C,a as _,I as k,b as le}from"./PlusIcon-CtLI7RNP.js";import{u as O,B as w,T as $,I as L,a as oe,b as E,s as D,c as ce,d as V,C as v,P as de}from"./productSkeleton-OA5_JX-h.js";import{t as me,S as xe}from"./truncateText-DCYr2heY.js";import{l as he,q as ge,m as pe,p as ue}from"./XMarkIcon-CR00bvNx.js";import{p as be}from"./chunk-MRXO6UUP-nmik_M5x.js";import"./useHover-BojuH7IM.js";import"./transition-iMQxfHpN.js";import"./clsx-B-dksMZM.js";import"./assertThisInitialized-CUbX1Gq7.js";import"./hoist-non-react-statics.cjs-C4SqqP4T.js";import"./useFocus-CiKVCmpT.js";import"./useFocusWithin-Cnv4cfRz.js";import"./useEffectEvent-Cg1JSw20.js";import"./chunk-N2KXC5ZE-mxrXGXiM.js";import"./chunk-XHQUSKIE-BwnSvnTo.js";import"./_class_private_field_set-DiTYLpP0.js";import"./chunk-MNNRULGA-Ck-UmubQ.js";import"./index-xaiLQO7O.js";import"./chunk-BZCSOIUI-ECjOxws-.js";const F=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"size-4",children:e.jsx("path",{fillRule:"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14Zm2.78-4.22a.75.75 0 0 1-1.06 0L8 9.06l-1.72 1.72a.75.75 0 1 1-1.06-1.06L6.94 8 5.22 6.28a.75.75 0 0 1 1.06-1.06L8 6.94l1.72-1.72a.75.75 0 1 1 1.06 1.06L9.06 8l1.72 1.72a.75.75 0 0 1 0 1.06Z",clipRule:"evenodd"})}),je=({onchange:a,filters:i})=>{const r=N(),g=y(s=>s.productClient.getAllBrandPageAuction.brands||[]),[m,x]=p.useState([]);p.useEffect(()=>{r(z())},[r]),p.useEffect(()=>{i.brand?x(i.brand):x([])},[i.brand]);const f=s=>{const t=m.some(n=>n._id===s._id)?m.filter(n=>n._id!==s._id):[...m,s];x(t),a&&a(t)},c=()=>{x([]),a&&a([])},o=[{value:"select-all",label:"Bỏ chọn tất cả",checked:!1},...g.map(s=>({value:s._id,label:s.name,checked:m.some(l=>l._id===s._id),brand:s}))],u=m.length>0;return e.jsxs(P,{as:"div",className:"border-t border-gray-200 py-6",children:[e.jsx("h3",{className:"-my-3 flow-root",children:e.jsxs(S,{className:"group flex w-full items-center justify-between bg-white px-2 py-3 text-sm text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"Thương hiệu"}),e.jsxs("span",{className:"ml-6 flex items-center",children:[e.jsx(C,{"aria-hidden":"true",className:"h-5 w-5 group-data-[open]:hidden"}),e.jsx(_,{"aria-hidden":"true",className:"h-5 w-5 [.group:not([data-open])_&]:hidden"})]})]})}),e.jsx(k,{className:"pt-6",children:e.jsx("div",{className:"space-y-4",children:o.map((s,l)=>e.jsx("div",{className:"flex items-center px-2",children:s.value==="select-all"?e.jsxs("button",{type:"button",className:`flex items-center px-2 ${u?"text-gray-600":"opacity-50 cursor-not-allowed"}`,onClick:c,disabled:!u,children:[e.jsx(F,{}),e.jsx("span",{className:"ml-2 text-sm",children:"Bỏ chọn"})]}):e.jsxs("div",{className:"flex items-center px-2",children:[e.jsx("input",{checked:s.checked,id:`filter-brand-${l}`,name:"brand",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",onChange:()=>s.brand&&f(s.brand)}),e.jsx("label",{htmlFor:`filter-brand-${l}`,className:"ml-3 text-sm text-gray-600",children:s.label})]})},s.value))})})]})},fe=({onchange:a})=>{const i=O(),[r,g]=p.useState({minPrice:0,maxPrice:0}),[m,x]=p.useState(null),f=l=>new Intl.NumberFormat("vi-VN").format(l),c=l=>parseFloat(l.replace(/[^\d]/g,""))||0,o=l=>{const{name:t,value:n}=l.target;g(d=>({...d,[t]:c(n)}))},u=()=>{if(!r.minPrice||!r.maxPrice){x("Vui lòng điền khoảng giá phù hợp");return}r.minPrice>r.maxPrice?x("Giá trị đầu phải nhỏ hơn hoặc bằng giá trị sau"):(x(null),a&&a(r.minPrice,r.maxPrice))},s=()=>{g({minPrice:0,maxPrice:0}),x(null),a&&a(null,null)};return e.jsxs(w,{sx:{padding:i.spacing(1)},children:[e.jsx("span",{className:"font-bold text-gray-900 text-sm",children:"Lọc theo khoảng giá"}),e.jsxs(w,{sx:{display:"flex",flexFlow:"row nowrap",alignItems:"center",marginTop:i.spacing(1),marginBottom:i.spacing(1)},children:[e.jsx($,{name:"minPrice",label:"Giá tối thiểu",onChange:o,value:f(r.minPrice),fullWidth:!0,variant:"filled",color:"primary",focused:!0,InputProps:{endAdornment:e.jsx(L,{position:"end",children:"₫"})}}),e.jsx("span",{style:{margin:"0 8px"},children:"-"}),e.jsx($,{name:"maxPrice",label:"Giá tối đa",onChange:o,value:f(r.maxPrice),fullWidth:!0,variant:"filled",color:"primary",focused:!0,InputProps:{endAdornment:e.jsx(L,{position:"end",children:"₫"})}})]}),m&&e.jsx(oe,{color:"error",variant:"caption",children:m}),e.jsxs(w,{sx:{display:"flex",gap:i.spacing(1),marginTop:i.spacing(2)},children:[e.jsx(E,{variant:"contained",color:"primary",onClick:u,size:"small",sx:{fontFamily:"'Barlow', sans-serif"},children:"Áp dụng"}),e.jsx(E,{variant:"contained",color:"success",onClick:s,size:"small",sx:{fontFamily:"'Barlow', sans-serif"},children:"Xóa bộ lọc"})]})]})},ye=({onchange:a,filters:i})=>{const r=N(),g=y(s=>s.getAttributes.getAllRam.rams||[]),[m,x]=p.useState([]);p.useEffect(()=>{r(J())},[r]),p.useEffect(()=>{i.ram?x(i.ram):x([])},[i.ram]);const f=s=>{const t=m.some(n=>n._id===s._id)?m.filter(n=>n._id!==s._id):[...m,s];x(t),a&&a(t)},c=()=>{x([]),a&&a([])},o=[{value:"select-all",label:"Bỏ chọn tất cả",checked:!1},...g.map(s=>({value:s._id,label:s.name,checked:m.some(l=>l._id===s._id),ram:s}))],u=m.length>0;return e.jsxs(P,{as:"div",className:"border-t border-gray-200 py-6",children:[e.jsx("h3",{className:"-my-3 flow-root",children:e.jsxs(S,{className:"group flex w-full items-center justify-between bg-white px-2 py-3 text-sm text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"RAM"}),e.jsxs("span",{className:"ml-6 flex items-center",children:[e.jsx(C,{"aria-hidden":"true",className:"h-5 w-5 group-data-[open]:hidden"}),e.jsx(_,{"aria-hidden":"true",className:"h-5 w-5 [.group:not([data-open])_&]:hidden"})]})]})}),e.jsx(k,{className:"pt-6",children:e.jsx("div",{className:"space-y-4",children:o.map((s,l)=>e.jsx("div",{className:"flex items-center px-2",children:s.value==="select-all"?e.jsxs("button",{type:"button",className:`flex items-center px-2 ${u?"text-gray-600":"opacity-50 cursor-not-allowed"}`,onClick:c,disabled:!u,children:[e.jsx(F,{}),e.jsx("span",{className:"ml-2 text-sm",children:"Bỏ chọn"})]}):e.jsxs("div",{className:"flex items-center px-2",children:[e.jsx("input",{checked:s.checked,id:`filter-ram-${l}`,name:"ram",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",onChange:()=>s.ram&&f(s.ram)}),e.jsx("label",{htmlFor:`filter-ram-${l}`,className:"ml-3 text-sm text-gray-600",children:s.label})]})},s.value))})})]})},ve=({onchange:a,filters:i})=>{const r=N(),g=y(s=>s.productClient.getAllConditionShoppingPageAuction.conditionShopping||[]),[m,x]=p.useState([]);p.useEffect(()=>{r(G())},[r]),p.useEffect(()=>{i.conditionShopping?x(i.conditionShopping):x([])},[i.conditionShopping]);const f=s=>{const t=m.some(n=>n._id===s._id)?m.filter(n=>n._id!==s._id):[...m,s];x(t),a&&a(t)},c=()=>{x([]),a&&a([])},o=[{value:"select-all",label:"Bỏ chọn tất cả",checked:!1},...g.map(s=>({value:s._id,label:s.nameCondition,checked:m.some(l=>l._id===s._id),condition:s}))],u=m.length>0;return e.jsxs(P,{as:"div",className:"border-t border-gray-200 py-6",children:[e.jsx("h3",{className:"-my-3 flow-root",children:e.jsxs(S,{className:"group flex w-full items-center justify-between bg-white px-2 py-3 text-sm text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"Điều kiện mua sắm"}),e.jsxs("span",{className:"ml-6 flex items-center",children:[e.jsx(C,{"aria-hidden":"true",className:"h-5 w-5 group-data-[open]:hidden"}),e.jsx(_,{"aria-hidden":"true",className:"h-5 w-5 [.group:not([data-open])_&]:hidden"})]})]})}),e.jsx(k,{className:"pt-6",children:e.jsx("div",{className:"space-y-4",children:o.map((s,l)=>e.jsx("div",{className:"flex items-center px-2",children:s.value==="select-all"?e.jsxs("button",{type:"button",className:`flex items-center px-2 ${u?"text-gray-600":"opacity-50 cursor-not-allowed"}`,onClick:c,disabled:!u,children:[e.jsx(F,{}),e.jsx("span",{className:"ml-2 text-sm",children:"Bỏ chọn"})]}):e.jsxs("div",{className:"flex items-center px-2",children:[e.jsx("input",{checked:s.checked,id:`filter-condition-${l}`,name:"conditionShopping[]",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",onChange:()=>s.condition&&f(s.condition)}),e.jsx("label",{htmlFor:`filter-condition-${l}`,className:"ml-3 text-sm text-gray-600",children:s.label})]})},s.value??`null-option-${l}`))})})]})},Ne=({onchange:a,filters:i})=>{const r=N(),g=y(s=>s.getAttributes.getAllStorage.storages||[]),[m,x]=p.useState([]);p.useEffect(()=>{r(K())},[r]),p.useEffect(()=>{i.storage?x(i.storage):x([])},[i.storage]);const f=s=>{const t=m.some(n=>n._id===s._id)?m.filter(n=>n._id!==s._id):[...m,s];x(t),a&&a(t)},c=()=>{x([]),a&&a([])},o=[{value:"select-all",label:"Bỏ chọn tất cả",checked:!1},...g.map(s=>({value:s._id,label:s.name,checked:m.some(l=>l._id===s._id),storage:s}))],u=m.length>0;return e.jsxs(P,{as:"div",className:"border-t border-gray-200 py-6",children:[e.jsx("h3",{className:"-my-3 flow-root",children:e.jsxs(S,{className:"group flex w-full items-center justify-between bg-white px-2 py-3 text-sm text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"Storage"}),e.jsxs("span",{className:"ml-6 flex items-center",children:[e.jsx(C,{"aria-hidden":"true",className:"h-5 w-5 group-data-[open]:hidden"}),e.jsx(_,{"aria-hidden":"true",className:"h-5 w-5 [.group:not([data-open])_&]:hidden"})]})]})}),e.jsx(k,{className:"pt-6",children:e.jsx("div",{className:"space-y-4",children:o.map((s,l)=>e.jsx("div",{className:"flex items-center px-2",children:s.value==="select-all"?e.jsxs("button",{type:"button",className:`flex items-center px-2 ${u?"text-gray-600":"opacity-50 cursor-not-allowed"}`,onClick:c,disabled:!u,children:[e.jsx(F,{}),e.jsx("span",{className:"ml-2 text-sm",children:"Bỏ chọn"})]}):e.jsxs("div",{className:"flex items-center px-2",children:[e.jsx("input",{checked:s.checked,id:`filter-storage-${l}`,name:"storage",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",onChange:()=>s.storage&&f(s.storage)}),e.jsx("label",{htmlFor:`filter-storage-${l}`,className:"ml-3 text-sm text-gray-600",children:s.label})]})},s.value))})})]})},I=({filters:a,onChange:i=()=>{}})=>{const r=c=>{const o={...a,brand:c.length>0?c:void 0};i(o)},g=c=>{const o={...a,conditionShopping:c.length>0?c:void 0};i(o)},m=c=>{const o={...a,storage:c.length>0?c:void 0};i(o)},x=c=>{const o={...a,ram:c.length>0?c:void 0};i(o)},f=(c,o)=>{const u={...a,minPrice:c!==null?c:void 0,maxPrice:o!==null?o:void 0};i(u)};return e.jsxs("div",{children:[e.jsx(fe,{onchange:f}),e.jsx(je,{filters:a,onchange:r}),e.jsx(ye,{filters:a,onchange:x}),e.jsx(Ne,{filters:a,onchange:m}),e.jsx(ve,{filters:a,onchange:g})]})};function B(a){return Y.format(a,{code:"VND",symbol:""})}function we({product:a,index:i}){return e.jsxs("div",{className:"relative w-full flex-col overflow-hidden rounded-lg border border-gray-100 bg-white shadow-md",children:[e.jsx("div",{className:"backdrop-blur-sm bg-white/30",children:e.jsx(U,{to:`/product/${a.slug}`,children:e.jsx("figure",{className:"relative w-full h-0 pb-[100%] overflow-hidden transition-all duration-300 cursor-pointer filter grayscale-0",children:e.jsx("img",{className:"absolute inset-0 w-full h-full object-cover rounded-lg p-8",src:a.image[0],alt:`product ${i+1}`})})})}),e.jsxs("div",{className:"pt-1 mb-10",children:[e.jsx("div",{className:"mb-4 px-2 flex items-center justify-between gap-4",children:a.variants.length>0&&a.variants[0].product_discount.isActive&&e.jsxs("span",{className:"rounded bg-primary-100 px-2.5 py-0.5 text-xs font-medium text-primary-800 dark:bg-primary-900 dark:text-primary-300",children:["Giảm giá ",a.variants[0].product_discount.discountPercent,"%"]})}),e.jsx("div",{className:"text-md font-semibold leading-tight text-gray-900 hover:text-balance dark:text-white",children:e.jsx("div",{className:"mt-1 px-2 pb-1",children:e.jsx("a",{href:"#",children:e.jsx("h5",{className:"text-sm tracking-tight text-slate-900 font-medium",children:me(a.product_name,30)})})})}),e.jsxs("div",{className:"px-2 flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.product_ratingAvg?a.product_ratingAvg.toFixed(1):"N/A"}),e.jsx(xe,{})]}),e.jsx("div",{className:"mt-2 px-2 flex items-center gap-2",children:a.variants.length>0&&(a.variants[0].product_discount.discountPercent>0?e.jsxs("div",{className:"flex w-full",children:[e.jsxs("p",{className:"text-xs font-medium text-rose-700 flex-grow",children:[B(a.variants[0].variant_price)," đ"]}),e.jsxs("p",{className:"text-xs font-medium text-gray-400 line-through flex-shrink-0",children:[B(a.variants[0].variant_original_price)," đ"]})]}):e.jsxs("p",{className:"text-xs font-medium text-rose-700",children:[B(a.variants[0].variant_price)," đ"]}))}),e.jsx("div",{className:"mt-2 px-2",children:e.jsx("div",{className:"mt-2 flex flex-wrap gap-4",children:a.variants.map((r,g)=>r.storage?e.jsx("div",{className:`flex items-center justify-center w-auto h-auto p-1 text-sm border border-gray-300 rounded-md 
          ${g===0?"border-primary-700 text-primary-700 bg-customGray":"text-gray-800"}`,children:e.jsx("p",{className:"font-medium",children:r.storage.name?r.storage.name:"N/A"})},g):null)})})]})]},i)}function Pe({products:a}){return e.jsx("div",{className:D.gridContainer,children:a.map((i,r)=>e.jsx(we,{product:i,index:r},r))})}const Se=({currentSort:a,onChange:i})=>{const r=(g,m)=>{i&&i(m)};return e.jsxs("div",{className:"pb-1",children:[" ",e.jsxs(ce,{value:a,indicatorColor:"primary",textColor:"primary",onChange:r,"aria-label":"sort tabs example",children:[e.jsx(V,{label:"Giá thấp tới cao",value:"variant_price:ASC",sx:{fontFamily:"'Be Vietnam Pro', sans-serif"}}),e.jsx(V,{label:"Giá cao xuống thấp",value:"variant_price:DESC",sx:{fontFamily:"'Be Vietnam Pro', sans-serif"}})]})]})},Ce=({filters:a,onChange:i})=>{const r=O(),g=t=>t!==null?new Intl.NumberFormat("vi-VN").format(t):"Chưa xác định",m=p.useMemo(()=>[{id:1,type:"condition",getLabel:t=>(t.conditionShopping??[]).map(d=>d.nameCondition).join(", ")||"Điều kiện mua sắm",isVisible:t=>t.conditionShopping&&t.conditionShopping.length>0,isActive:t=>t.conditionShopping&&t.conditionShopping.length>0,isRemovable:!0,onRemove:t=>{const n={...t};return delete n.conditionShopping,n},onToggle:t=>t},{id:2,type:"price",getLabel:t=>`Từ ${g(t.minPrice??null)} đến ${g(t.maxPrice??null)}`,isVisible:t=>t.minPrice!==void 0&&t.maxPrice!==void 0,isActive:t=>t.minPrice!==void 0&&t.maxPrice!==void 0,isRemovable:!0,onRemove:t=>{const n={...t};return delete n.minPrice,delete n.maxPrice,n},onToggle:t=>t},{id:3,type:"brand",getLabel:t=>(t.brand??[]).map(d=>d.name).join(", ")||"Thương hiệu",isVisible:t=>t.brand&&t.brand.length>0,isActive:t=>t.brand&&t.brand.length>0,isRemovable:!0,onRemove:t=>{const n={...t};return delete n.brand,n},onToggle:t=>t},{id:4,type:"discount",getLabel:t=>{const n=t.minDiscountPercent??null;return n!==null?`Giảm giá từ ${n}%`:"Giảm giá"},isVisible:t=>t.minDiscountPercent!==void 0,isActive:t=>t.minDiscountPercent!==void 0,isRemovable:!0,onRemove:t=>{const n={...t};return delete n.minDiscountPercent,delete n.maxDiscountPercent,n},onToggle:t=>t},{id:5,type:"ram",getLabel:t=>(t.ram??[]).map(d=>d.name).join(", ")||"Ram",isVisible:t=>t.ram&&t.ram.length>0,isActive:t=>t.ram&&t.ram.length>0,isRemovable:!0,onRemove:t=>{const n={...t};return delete n.ram,n},onToggle:t=>t},{id:6,type:"storage",getLabel:t=>(t.storage??[]).map(d=>d.name).join(", ")||"Storage",isVisible:t=>t.storage&&t.storage.length>0,isActive:t=>t.storage&&t.storage.length>0,isRemovable:!0,onRemove:t=>{const n={...t};return delete n.storage,n},onToggle:t=>t}],[a]),x=p.useMemo(()=>m.filter(t=>t.isVisible(a)),[a,m]),f=t=>{const n=(a.conditionShopping??[]).filter(b=>b._id!==t),d={...a,conditionShopping:n};i&&i(d)},c=t=>{const n=(a.brand??[]).filter(b=>b._id!==t),d={...a,brand:n};i&&i(d)},o=t=>{const n=(a.ram??[]).filter(b=>b._id!==t),d={...a,ram:n};i&&i(d)},u=t=>{const n=(a.storage??[]).filter(b=>b._id!==t),d={...a,storage:n};i&&i(d)},s=()=>{const t={...a};delete t.minPrice,delete t.maxPrice,i&&i(t)},l=()=>{const t={...a};delete t.minDiscountPercent,delete t.maxDiscountPercent,i&&i(t)};return e.jsx(w,{component:"ul",sx:{padding:r.spacing(1),display:"flex",flexFlow:"row wrap",alignItems:"center",listStyleType:"none"},children:x.map(t=>e.jsxs("li",{children:[t.type==="condition"&&(a.conditionShopping??[]).map(n=>e.jsx(v,{label:n.nameCondition,color:"primary",size:"small",onDelete:()=>f(n._id),sx:{margin:r.spacing(.5)}},n._id)),t.type==="price"&&e.jsx(v,{label:t.getLabel(a),color:"primary",size:"small",onDelete:s,sx:{margin:r.spacing(.5)}}),t.type==="brand"&&(a.brand??[]).map(n=>e.jsx(v,{label:n.name,color:"primary",size:"small",onDelete:()=>c(n._id),sx:{margin:r.spacing(.5)}},n._id)),t.type==="ram"&&(a.ram??[]).map(n=>e.jsx(v,{label:n.name,color:"primary",size:"small",onDelete:()=>o(n._id),sx:{margin:r.spacing(.5)}},n._id)),t.type==="storage"&&(a.storage??[]).map(n=>e.jsx(v,{label:n.name,color:"primary",size:"small",onDelete:()=>u(n._id),sx:{margin:r.spacing(.5)}},n._id)),t.type==="discount"&&e.jsx(v,{label:t.getLabel(a),color:"primary",size:"small",onDelete:l,sx:{margin:r.spacing(.5)}})]},t.id))})},_e=()=>e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px] p-4 text-center text-gray-500",children:[e.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/xprojreact.appspot.com/o/no-product%2Fno-product.png?alt=media&token=1ed14df4-2023-4e13-b25e-ba4296975c6c",alt:"No products",className:"w-32 h-32 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Hix. Không có sản phẩm nào. Bạn thử tắt điều kiện lọc và tìm lại nhé?"})]}),ke=(a,i)=>{const r=a.find(g=>g._id===i);return r?r.name:" không xác định Brand"},Fe=(a,i)=>{const r=a.find(g=>g._id===i);return r?r.nameCondition:" không xác định Condition"},Ae=(a,i)=>{const r=a.find(g=>g._id===i);return r?r.name:"không xác định RAM"},Be=(a,i)=>{const r=a.find(g=>g._id===i);return r?r.name:"không xác định Storage"},Re=(a,i,r,g,m)=>{const x=ee(),f=M(),c={...a,...R.parse(f.search)},[o,u]=p.useState({_sort:c._sort||"variant_price:ASC",brand:c.brand?c.brand.split(",").map(s=>({_id:s,name:ke(i,s)})):[],conditionShopping:c.conditionShopping?c.conditionShopping.split(",").map(s=>({_id:s,nameCondition:Fe(r,s)})):[],ram:c.ram?c.ram.split(",").map(s=>{const l=Ae(g,s);return{_id:s,name:l,status:l,sku:l,pid:l,createdAt:l,updatedAt:l,slug:l}}):[],storage:c.storage?c.storage.split(",").map(s=>{const l=Be(m,s);return{_id:s,name:l,status:l,sku:l,pid:l,createdAt:l,updatedAt:l,slug:l}}):[],minPrice:c.minPrice?parseFloat(c.minPrice):void 0,maxPrice:c.maxPrice?parseFloat(c.maxPrice):void 0,minDiscountPercent:c.minDiscountPercent?parseFloat(c.minDiscountPercent):void 0,maxDiscountPercent:c.maxDiscountPercent?parseFloat(c.maxDiscountPercent):void 0,page:Number(c.page)||1});return p.useEffect(()=>{var l,t,n,d;const s={};o._sort&&(s._sort=o._sort),(l=o.brand)!=null&&l.length&&(s.brand=o.brand.map(b=>b._id).join(",")),(t=o.conditionShopping)!=null&&t.length&&(s.conditionShopping=o.conditionShopping.map(b=>b._id).join(",")),(n=o.ram)!=null&&n.length&&(s.ram=o.ram.map(b=>b._id).join(",")),(d=o.storage)!=null&&d.length&&(s.storage=o.storage.map(b=>b._id).join(",")),o.minPrice!==void 0&&(s.minPrice=String(o.minPrice)),o.maxPrice!==void 0&&(s.maxPrice=String(o.maxPrice)),o.minDiscountPercent!==void 0&&(s.minDiscountPercent=String(o.minDiscountPercent)),o.maxDiscountPercent!==void 0&&(s.maxDiscountPercent=String(o.maxDiscountPercent)),typeof o.page=="number"&&(s.page=o.page),x({pathname:window.location.pathname,search:R.stringify(s)})},[x,o]),[o,u]};function De(){const{slug:a}=te(),i=N(),r=M(),g=R.parse(r.search),m=y(h=>{var j;return((j=h.productClient.getProductsByCategory.pagination)==null?void 0:j.currentPage)||1}),x=y(h=>{var j;return((j=h.productClient.getProductsByCategory.pagination)==null?void 0:j.totalPages)||1}),f=y(h=>h.productClient.getProductsByCategory.products||[]),c=y(h=>h.productClient.getProductsByCategory.total||0),o=y(h=>h.productClient.getProductsByCategory.category),u=y(h=>h.productClient.getProductsByCategory.isLoading),s=y(h=>h.productClient.getAllBrandPageAuction.brands||[]),l=y(h=>h.productClient.getAllConditionShoppingPageAuction.conditionShopping||[]),t=y(h=>h.productClient.getAllRam.rams||[]),n=y(h=>h.productClient.getAllStorage.storages||[]);p.useEffect(()=>{i(z()),i(G()),i(se()),i(ae())},[i]);const[d,b]=Re(g,s,l,t,n),q=!u&&f.length===0;p.useEffect(()=>{a&&i(ne({slug:a,page:d.page,limit:d.limit,_sort:d._sort,brand:d.brand||[],ram:d.ram||[],storage:d.storage||[],conditionShopping:d.conditionShopping||[],minPrice:d.minPrice,maxPrice:d.maxPrice,minDiscountPercent:d.minDiscountPercent,maxDiscountPercent:d.maxDiscountPercent}))},[i,d,a]);const W=h=>{b(j=>({...j,_sort:h}))},Q=h=>{b(j=>({...j,page:h}))},T=p.useCallback(h=>{b(j=>({...j,...h}))},[]),X=p.useCallback(h=>{b(h)},[]),Z=Object.keys(d).some(h=>{const j=d[h];return!(h==="_sort"&&(j==="variant_price:ASC"||j==="variant_price:DESC")||h==="page"&&j===1||Array.isArray(j)&&j.length===0||j==null||j==="")}),[H,A]=p.useState(!1);return e.jsxs("div",{children:[e.jsx(ie,{items:re.productlist}),e.jsx("div",{className:"w-full max-w-screen-2xl px-0 bg-white",children:e.jsxs("div",{children:[e.jsxs(he,{open:H,onClose:A,className:"relative z-40 lg:hidden",children:[e.jsx(ge,{transition:!0,className:"fixed inset-0 bg-black bg-opacity-25 transition-opacity duration-300 ease-linear data-[closed]:opacity-0"}),e.jsx("div",{className:"fixed inset-0 z-40 flex",children:e.jsxs(pe,{transition:!0,className:"relative ml-auto flex h-full w-full max-w-xs transform flex-col overflow-y-auto bg-white py-4 pb-12 shadow-xl transition duration-300 ease-in-out data-[closed]:translate-x-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Filters"}),e.jsxs("button",{type:"button",onClick:()=>A(!1),className:"-mr-2 flex h-10 w-10 items-center justify-center rounded-md bg-white p-2 text-gray-400",children:[e.jsx("span",{className:"sr-only",children:"Close menu"}),e.jsx(ue,{"aria-hidden":"true",className:"h-6 w-6"})]})]}),e.jsxs("form",{className:"mt-4 border-t border-gray-200",children:[e.jsx("h3",{className:"sr-only",children:"Categories"}),e.jsx(I,{filters:d,onChange:T})]})]})})]}),e.jsx("main",{className:"w-full max-w-screen-2xl px-0 sm:px-6 lg:px-5",children:e.jsxs("section",{"aria-labelledby":"products-heading",className:"pb-24 pt-4",children:[e.jsx("h2",{id:"products-heading",className:"sr-only",children:"sản phẩm"}),e.jsxs("div",{className:"grid grid-cols-1 gap-x-0.5 gap-y-10 lg:grid-cols-4",children:[e.jsxs("div",{className:"lg:col-span-1",children:[" ",e.jsxs("form",{className:"hidden lg:block rounded-lg border border-gray-100 bg-white shadow-sm ",children:[e.jsx("h3",{className:"sr-only",children:"Categories"}),e.jsx(I,{filters:d,onChange:T})]})," "]}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("div",{className:"bg-white shadow-md sm:rounded-t-lg  overflow-hidden border border-gray-100 antialiased dark:bg-gray-900 md:py-4",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-2",children:[e.jsxs("h1",{className:"text-xl font-barlow font-bold text-gray-900",children:[o&&o.trim()!==""?`${o} `:"Sản phẩm",e.jsxs("span",{className:"text-lg font-medium text-gray-500",children:[" (có ",c," sản phẩm)"]})]}),e.jsxs("button",{type:"button",onClick:()=>A(!0),className:"ml-4 p-2 text-gray-400 hover:text-gray-500 lg:hidden",children:[e.jsx("span",{className:"sr-only",children:"Filters"}),e.jsx(le,{"aria-hidden":"true",className:"h-5 w-5"})]})]})}),Z&&e.jsx("div",{className:"bg-white shadow-md overflow-hidden border border-gray-100 antialiased dark:bg-gray-900 md:py-4",children:e.jsxs("div",{className:"flex items-center px-4 py-2",children:[e.jsx("h1",{className:"text-lg font-barlow font-medium text-gray-900",children:"Bộ lọc hiện tại"}),e.jsx(Ce,{filters:d,onChange:X})]})}),e.jsx("div",{className:"bg-white",children:e.jsxs("section",{className:D.sectionContainer,children:[e.jsx(Se,{currentSort:d._sort,onChange:W}),e.jsx("div",{className:D.container,children:u?e.jsx(de,{length:12}):q?e.jsx(_e,{}):e.jsx(Pe,{products:f})}),x>1&&e.jsx("div",{className:"flex justify-center my-4",children:e.jsx(be,{isCompact:!0,loop:!0,showControls:!0,color:"primary",total:x,initialPage:m,onChange:h=>Q(h)})})]})})]})]})]})})]})})]})}const tt=()=>e.jsx(e.Fragment,{children:e.jsx(De,{})});export{tt as default};
