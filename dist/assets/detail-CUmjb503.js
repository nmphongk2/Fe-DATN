import{j as e,_ as M,r as l,s as Q,z as U,h as I,f as q,m as z,$ as G,a0 as J,a1 as O,a2 as Y,L as Z,J as X,i as R,a3 as ee,K as se}from"./index-B8WTsAS6.js";import{a as te,u as re}from"./homeAllProduct-C-dyKhCz.js";/* empty css                */import{Q as ae}from"./react-toastify.esm-BnAFxftJ.js";/* empty css                      */import{f as ie}from"./relatedProducts-DfzS27j0.js";import"./clsx-B-dksMZM.js";const ne=({fill:n="red",size:c="1em"})=>e.jsx("svg",{viewBox:"0 0 512 512",fill:n,height:c,width:c,children:e.jsx("path",{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm74.69 252.82c-9.38 11.44-26.4 29.73-65.7 56.41a15.93 15.93 0 01-18 0c-39.3-26.68-56.32-45-65.7-56.41-20-24.37-29.58-49.4-29.3-76.5.31-31.06 25.22-56.33 55.53-56.33 20.4 0 35 10.63 44.1 20.41a6 6 0 008.72 0c9.11-9.78 23.7-20.41 44.1-20.41 30.31 0 55.22 25.27 55.53 56.33.3 27.1-9.29 52.13-29.28 76.5z"})}),le=()=>e.jsx("svg",{className:"h-4 w-4 text-yellow-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M13.8 4.2a2 2 0 0 0-3.6 0L8.4 8.4l-4.6.3a2 2 0 0 0-1.1 3.5l3.5 3-1 4.4c-.5 1.7 1.4 3 2.9 2.1l3.9-2.3 3.9 2.3c1.5 1 3.4-.4 3-2.1l-1-4.4 3.4-3a2 2 0 0 0-1.1-3.5l-4.6-.3-1.8-4.2Z"})}),ce="http://localhost:4000/api/interaction",oe=async n=>{try{return(await M.post(`${ce}/interactions-view`,n,{headers:{"Content-Type":"application/json"}})).data}catch(c){return c}},de=["Ram","Color","Storage","Screen","CPU","Pin"];function h(n){return X.format(n,{code:"VND",symbol:""})}const he=()=>{var b,N,v,w,k,_,P;const[n,c]=l.useState(1),[t,D]=l.useState(null),[C,A]=l.useState([]),[p,$]=l.useState(0),[u,T]=l.useState({}),g=Q(s=>s.auth.profile.profile),V=(s,r)=>{T(a=>({...a,[s]:r}))},{id:i}=U(),F=I(s=>{var r;return(r=s.auth.profile.profile)==null?void 0:r._id}),[f,m]=l.useState(null),[j,d]=l.useState(!1),x=q(),y=I(s=>s.watchlist),L=()=>c(n+1),E=()=>{n>1&&c(n-1)},W=async()=>{try{const s=await x(R()).unwrap();if(Array.isArray(s)){const r=s.some(a=>{var o;return((o=a==null?void 0:a.product)==null?void 0:o._id)===i});d(r),console.log("Sản phẩm có trong danh sách yêu thích:",r)}else console.error("Danh sách yêu thích không hợp lệ:",s),d(!1)}catch(s){console.error("Không thể lấy danh sách yêu thích:",s)}},K=async()=>{if(!i){console.log("Thiếu ID sản phẩm hoặc profile người dùng.");return}const s={user:g==null?void 0:g._id,orderAuctions:null,item:i,OrderCart:null,productID:i,Watchlist:null,type:"view",score:2};try{console.log("Đang lấy thông tin sản phẩm với ID:",i);const[r,a]=await Promise.all([te(i),ie(i)]);if(D(r.product),a&&Array.isArray(a.relatedVariants)?A(a.relatedVariants):console.error("Lỗi: relatedData không phải là mảng",a),await Promise.all([re(i),oe(s)]),Array.isArray(y)){const o=y.some(S=>S.product&&S.product._id===i);d(o)}}catch(r){console.error("Không thể lấy hoặc cập nhật dữ liệu sản phẩm:",r)}};l.useEffect(()=>{i&&K()},[i]),l.useEffect(()=>{W(),x(z())},[x]);const B=async s=>{if(F&&i)try{let r;j?(r=await x(ee({productId:i,variantId:s})).unwrap(),console.log("Delete result action:",r),!r||typeof r!="object"||r._id,d(!1)):(r=await x(se({productId:i})).unwrap(),console.log("Add result action:",r),!r||typeof r!="object"||!r._id?(m("Lỗi khi thêm vào DS theo doi"),d(!1)):d(!0))}catch(r){r instanceof Error?(console.error("lỗi xử lý ds theo dõi:",r.message),m(r.message)):(console.error("Đã xảy ra lỗi không xác định:",r),m("Đã xảy ra lỗi không xác định."))}else console.log("User ID or Product ID is missing"),m("User ID or Product ID is missing")},H=s=>{$(s)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container py-4 flex items-center gap-3",children:[e.jsx("a",{href:"/",className:"text-primary text-base flex items-center",children:e.jsx("span",{className:"ml-2",children:"Sản phẩm"})}),e.jsx("span",{className:"text-sm text-gray-400 mx-2",children:e.jsx("i",{className:"fa-solid fa-chevron-right"})}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Chi tiết sản phẩm"})]}),e.jsxs("div",{className:"container grid grid-cols-1 md:grid-cols-2 gap-6 p-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-center items-center mb-4",children:e.jsx("img",{src:(b=t==null?void 0:t.image)==null?void 0:b[p],alt:"Ảnh chính"})}),e.jsx("div",{className:"flex justify-center gap-4",children:(N=t==null?void 0:t.image)==null?void 0:N.slice(0,4).map((s,r)=>e.jsx("img",{src:s,className:`w-20 h-16 object-cover cursor-pointer border border-gray-300 rounded ${r===p?"border-blue-500":""}`,onClick:()=>H(r)},r))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-semibold uppercase mb-2",children:t==null?void 0:t.product_name}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex gap-1 text-sm text-yellow-400",children:Array.from({length:5}).map((s,r)=>e.jsx("span",{children:e.jsx("i",{className:"fa-solid fa-star"})},r))}),e.jsxs("div",{className:"text-xs text-gray-500 ml-3",children:["(",t==null?void 0:t.product_view," Lượt xem)"]})]}),e.jsx("div",{className:"space-y-2 mb-4",children:e.jsxs("p",{className:"text-gray-800 font-semibold",children:[e.jsx("span",{children:"Trạng thái: "}),(t==null?void 0:t.product_quantity)>0?e.jsx("span",{className:"text-green-600",children:"Còn Hàng"}):e.jsx("span",{className:"text-red-600",children:"Hết Hàng"})]})}),e.jsx("div",{className:"flex items-baseline mb-4 space-x-2 font-roboto",children:((v=t==null?void 0:t.product_discount)==null?void 0:v.discountPercent)>0?e.jsxs("div",{children:[e.jsxs("p",{className:"text-xl text-red-600 font-semibold",children:[h((t==null?void 0:t.product_price)*(1-((w=t==null?void 0:t.product_discount)==null?void 0:w.discountPercent)/100)),"đ"]}),e.jsxs("p",{className:"text-sm text-gray-400 line-through",children:[h(t==null?void 0:t.product_price),"đ"]})]}):e.jsxs("p",{className:"text-xl text-primary font-semibold",children:[h(t==null?void 0:t.product_price),"đ"]})}),e.jsxs("div",{className:"pt-2",children:[e.jsx("h3",{className:"text-xl text-gray-800 mb-3 uppercase font-medium",children:"Các phiên bản"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(k=t==null?void 0:t.product_attributes)!=null&&k.length?(_=t.product_attributes)==null?void 0:_.filter(s=>["Ram","Color"].includes(s.k)).map((s,r)=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("strong",{className:"text-gray-800",children:[s.k,":"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.v.split(",").map((a,o)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:`${s.k}-${o}`,name:s.k,value:a.trim(),checked:u[s.k]===a.trim(),onChange:()=>V(s.k,a.trim()),className:"hidden"}),e.jsx("label",{htmlFor:`${s.k}-${o}`,className:`border rounded-sm h-8 w-32 flex items-center justify-center cursor-pointer text-gray-600 ${u[s.k]===a.trim()?"border-blue-500":"border-gray-300"}`,children:a.trim()})]},o))})]},r)):e.jsx("div",{children:"Không có thuộc tính sản phẩm"})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-xl text-gray-800 mb-3 uppercase font-medium",children:"Số lượng"}),e.jsxs("div",{className:"flex border border-gray-300 text-gray-600 divide-x divide-gray-300 w-max",children:[e.jsx("button",{className:"h-8 w-8 text-xl flex items-center justify-center cursor-pointer select-none bg-gray-200 hover:bg-gray-300 transition",onClick:E,children:"-"}),e.jsx("div",{className:"h-8 w-8 text-base flex items-center justify-center bg-gray-100",children:n}),e.jsx("button",{className:"h-8 w-8 text-xl flex items-center justify-center cursor-pointer select-none bg-gray-200 hover:bg-gray-300 transition",onClick:L,children:"+"})]})]}),e.jsxs("div",{className:"mt-6 flex gap-3 border-t border-gray-200 pt-5",children:[e.jsxs("a",{href:"/checkout",className:"bg-blue-600 text-white px-8 py-2 font-medium rounded uppercase flex items-center gap-2 hover:bg-blue-700 transition",children:[e.jsx("i",{className:"fa-solid fa-bag-shopping"})," Mua ngay"]}),e.jsxs("a",{className:"bg-green-600 text-white px-8 py-2 font-medium rounded uppercase flex items-center gap-2 hover:bg-green-700 transition",children:[e.jsx("i",{className:"fa-solid fa-bag-shopping"})," Thêm giỏ hàng"]}),f&&e.jsx("p",{className:"text-red-500",children:f}),e.jsxs("button",{onClick:()=>B(),className:"flex items-center space-x-2 bg-gray-200 text-white px-4 py-2 font-medium rounded uppercase hover:bg-gray-300 transition",children:[e.jsx("i",{className:`fas fa-heart ${j?"text-red-500":"text-gray-500"}`}),e.jsx("span",{className:"ml-2 text-slate-950",children:"Yêu thích"})]})]}),e.jsx("div",{className:"flex gap-3 mt-4",children:["facebook-f","twitter","linkedin-in","pinterest"].map(s=>e.jsx("a",{href:"#",className:"text-gray-400 hover:text-gray-500 h-8 w-8 rounded-full border border-gray-300 flex items-center justify-center",children:e.jsx("i",{className:`fa-brands fa-${s}`})},s))})]})]}),e.jsxs("div",{className:"container pb-16",children:[e.jsx("h3",{className:"border-b border-gray-200 font-roboto text-gray-800 pb-3 font-medium text-xl",children:"Thông tin chi tiết"}),e.jsx("div",{className:"pt-6",children:e.jsxs("table",{className:"table-auto border-collapse w-full text-left text-gray-600 text-sm",children:[(P=t==null?void 0:t.product_attributes)==null?void 0:P.filter(s=>de.includes(s.k)).map((s,r)=>e.jsxs("li",{className:"mb-1",children:[e.jsxs("strong",{children:[s.k,": "]}),e.jsx("span",{children:s.v})]},r)),e.jsxs("li",{children:[e.jsx("strong",{children:"Khối lượng:"})," ",e.jsxs("span",{children:[t==null?void 0:t.weight_g," kg"]})]})]})})]}),e.jsxs("div",{className:"container pb-16",children:[e.jsx("h2",{className:"text-2xl font-medium text-gray-800 uppercase mb-6",children:"Sản phẩm liên quan"}),e.jsx(G,{modules:[J,O],slidesPerView:1,spaceBetween:10,navigation:!0,pagination:{clickable:!0},breakpoints:{640:{slidesPerView:2},1024:{slidesPerView:4}},children:C.map((s,r)=>e.jsx(Y,{children:e.jsxs("div",{className:"relative w-full flex-col overflow-hidden rounded-lg border border-gray-100 bg-white shadow-md",children:[e.jsx("div",{className:"backdrop-blur-sm bg-white/30",children:e.jsx(Z,{to:`/detailProd/${s._id}`,children:e.jsx("figure",{className:"relative w-full h-0 pb-[75%] overflow-hidden transition-all duration-300 cursor-pointer filter grayscale-0",children:e.jsx("img",{className:"absolute inset-0 w-full h-full object-cover rounded-lg",src:s.image[0].image[0]||"null",alt:`product ${r+1}`})})})}),e.jsxs("div",{className:"pt-1 mb-10",children:[e.jsxs("div",{className:"mb-4 px-2 flex items-center justify-between gap-4",children:[s.product_discount.discountPercent>0?e.jsxs("span",{className:"rounded bg-primary-100 px-2.5 py-0.5 text-xs font-medium text-primary-800 dark:bg-primary-900 dark:text-primary-300",children:["Giảm giá"," ",s.product_discount.discountPercent,"%"]}):null,e.jsx("div",{className:"flex items-center justify-end gap-1",children:e.jsx("button",{type:"button",className:"rounded-lg p-2 text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white",children:e.jsx(ne,{fill:"red",size:"1em"})})})]}),e.jsx("div",{className:"text-md font-semibold leading-tight text-gray-900 hover:text-balance dark:text-white",children:e.jsx("div",{className:"mt-1 px-2 pb-1",children:e.jsx("a",{href:"#",children:e.jsx("h5",{className:"text-sm tracking-tight text-slate-900 font-medium",children:s.variant_name})})})}),e.jsxs("div",{className:"px-2 flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.product_ratingAvg?s.product_ratingAvg.toFixed(1):"N/A"}),e.jsx(le,{})]}),e.jsx("div",{className:"mt-2 px-2 flex items-center gap-2",children:s.product_discount.discountPercent>0?e.jsxs("div",{className:"flex w-full",children:[e.jsxs("p",{className:"text-xs font-medium text-rose-700 flex-grow",children:[h(s.variant_price*(1-s.product_discount.discountPercent/100))," ","đ"]}),e.jsxs("p",{className:"text-xs font-medium text-gray-400 line-through flex-shrink-0",children:[h(s.variant_price)," đ"]})]}):e.jsxs("p",{className:"text-xs font-medium text-rose-700",children:[h(s.variant_price)," đ"]})})]})]})},r))}),e.jsx(ae,{})]})]})},ye=()=>e.jsx(e.Fragment,{children:e.jsx(he,{})});export{ye as default};
