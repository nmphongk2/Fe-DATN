import{g as N,l as v,s as k,r as a,o as E,t as S,j as e,L as b,v as G,w as L}from"./index-B8WTsAS6.js";import{u as M}from"./index.esm-CH-ucXk-.js";import{B as t,Q as R}from"./react-toastify.esm-BnAFxftJ.js";/* empty css                      */import"./clsx-B-dksMZM.js";const T="http://localhost:4000/api",F={loginWithGoogle:()=>{window.open(`${T}/auth/google`,"_self")}},Q=()=>{const{register:m,handleSubmit:f,formState:{errors:l},getValues:y}=M(),i=N(),o=v(),{status:g,error:n}=k(r=>r.auth),[c,h]=a.useState(!1),[d,u]=a.useState(!1),p=E.get("token");a.useEffect(()=>{p?i("/"):o(S())},[p,i,o]),a.useEffect(()=>{g==="failed"&&n&&t.error(n)},[g,n]);const w=async r=>{try{const s=await o(G(r)).unwrap();t.success(s.message||"Mã xác thực đã được gửi lại!"),h(!1)}catch(s){t.error(s.message||"Gửi lại mã xác thực thất bại.")}},j=async r=>{u(!0),t.dismiss();try{const s=await o(L(r)).unwrap();s&&(t.success(s.message),s.redirectTo&&i(s.redirectTo))}catch(s){const x=s.message||"login failed. Please try again.";x==="Email chưa được xác minh"&&h(!0),t.dismiss(),t.error(x)}finally{u(!1)}};return a.useEffect(()=>{console.log("Nút resend sẽ hiển thị:",c)},[c]),e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("div",{className:"py-40  bg-gray-100",children:e.jsx("div",{className:"max-w-md mx-auto bg-white shadow-lg rounded-lg overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-gray-900",children:"Đăng Nhập"}),e.jsx("p",{className:"text-gray-600 mb-6 text-sm",children:"Chào mừng bạn trở lại! Đăng nhập để tiếp tục."}),e.jsxs("form",{onSubmit:f(j),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"text-gray-600 mb-2 block",children:"Email"}),e.jsx("input",{type:"email",id:"email",placeholder:"youremail@domain.com",className:"block w-full border border-gray-300 px-4 py-3 text-gray-700 text-sm rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 placeholder-gray-400",...m("email",{required:"Email không được bỏ trống",pattern:{value:/^\S+@\S+$/i,message:"Email không đúng định dạng"}})}),l.email&&e.jsx("small",{className:"text-red-600",children:l.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"text-gray-600 mb-2 block",children:"Mật khẩu"}),e.jsx("input",{type:"password",id:"password",placeholder:"Nhập mật khẩu.....",className:"block w-full border border-gray-300 px-4 py-3 text-gray-700 text-sm rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 placeholder-gray-400",...m("password",{required:"Mật khẩu không được bỏ trống",minLength:{value:6,message:"Mật khẩu phải có ít nhất 6 ký tự"}})}),l.password&&e.jsx("small",{className:"text-red-600",children:l.password.message})]}),e.jsx("div",{className:"flex items-center justify-between mt-6",children:e.jsx(b,{to:"/forgot",className:"text-primary hover:underline",children:"Quên mật khẩu?"})}),c&&e.jsx("button",{type:"button",onClick:()=>w(y("email")),className:"w-full py-2 mt-4 text-center bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:d?"Đang gửi mã...":"  Gửi lại mã xác thực"}),e.jsx("button",{type:"submit",disabled:d,className:"w-full py-2 text-center bg-yellow-400 text-white border border-yellow-400 rounded-lg hover:bg-yellow-500 focus:ring-2 focus:ring-yellow-500 transition duration-200",children:d?"Đang đăng nhập...":"Đăng nhập"})]}),e.jsxs("div",{className:"mt-6 relative",children:[e.jsx("div",{className:"text-gray-600 uppercase px-3 bg-white relative z-10 text-center",children:"Hoặc"}),e.jsx("div",{className:"absolute inset-x-0 top-1/2 border-b-2 border-gray-200"})]}),e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsx("a",{className:"w-1/2 py-2 text-center text-white bg-blue-800 rounded-lg uppercase font-medium text-sm hover:bg-blue-700",href:"#",children:"OTP"}),e.jsx("button",{onClick:F.loginWithGoogle,className:"w-1/2 py-2 text-center text-white bg-red-600 rounded-lg uppercase font-medium text-sm hover:bg-red-500",children:"Đăng nhập với Google"})]}),e.jsxs("p",{className:"mt-4 text-center text-gray-600",children:["Bạn chưa có tài khoản?"," ",e.jsx(b,{to:"/register",className:"text-primary font-medium hover:underline",children:"Đăng ký ngay"})]})]})})})]})};export{Q as default};
