import{z as D,r as n,g as E,j as e,cE as c}from"./index-B8WTsAS6.js";import{u as S,C as o}from"./index.esm-CH-ucXk-.js";import{Q as P,B as a}from"./react-toastify.esm-BnAFxftJ.js";/* empty css                      */import{R as C,b as F}from"./ReusableBreadcrumb-D5trGug1.js";import"./clsx-B-dksMZM.js";const $=()=>{const{id:s}=D()||{id:""},[y,b]=n.useState(!1),f=E(),[,k]=n.useState([]),{control:m,handleSubmit:T,formState:{errors:i},setValue:d,setError:l,clearErrors:g,watch:u}=S(),h=u("endTime"),j=u("endTimeBid");n.useEffect(()=>{(async()=>{try{const r=await c.getProductBy();r.status===200?k(r.data):a.error("Lấy danh sách sản phẩm thất bại")}catch{a.error("Đã có lỗi xảy ra khi lấy sản phẩm")}})()},[]),n.useEffect(()=>{s&&(async()=>{try{const r=await c.getTimeTrackWithProductDetails(s||""),{name:x,endTime:w,endTimeBid:B}=r.data;d("name",x),d("endTime",p(w)),d("endTimeBid",p(B))}catch{a.error("Đã có lỗi xảy ra khi lấy thời gian theo dõi")}})()},[s,d]);const p=t=>{const r=t.split(/[/ :]/);return`${r[2]}-${r[1]}-${r[0]}T${r[3]}:${r[4]}`},N=()=>{const t=new Date,r=new Date(h||"");return h!==j?(l("endTimeBid",{type:"manual",message:"Thời gian kết thúc và thời gian kết thúc dự phòng phải giống nhau"}),!1):(r.getTime()-t.getTime())/(1e3*3600*24)>30?(l("endTime",{type:"manual",message:"Thời gian kết thúc không được lớn hơn 30 ngày so với ngày hiện tại"}),!1):(g("endTime"),g("endTimeBid"),!0)},v=async t=>{try{if(!N())return;const r={productName:t.name,productId:t.product_id,endTime:t.endTime,endTimeBid:t.endTimeBid};await c.editTimeTrackAdminService(s||"",r),a.success("Cập nhật thành công"),setTimeout(()=>{f("/admin/listProdAuc")},2e3)}catch{a.error("Cập nhật thất bại")}};return e.jsxs("form",{onSubmit:T(v),encType:"multipart/form-data",children:[e.jsx(P,{}),e.jsx(C,{items:F.editProducTime}),e.jsx("div",{className:"mb-4 ml-4 col-span-full xl:mb-2",children:e.jsx("h1",{className:"text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white",children:"Cập nhật thời gian đấu giá"})}),e.jsx("div",{className:"px-4 pt-4 xl:grid-cols-[1fr_2fr] xl:gap-4 dark:bg-gray-900",children:e.jsx("div",{className:"col-span-full xl:col-auto",children:e.jsxs("div",{className:"p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm dark:border-gray-700 dark:bg-gray-800",children:[e.jsx("h3",{className:"mb-4 text-xl font-semibold dark:text-white",children:"Tổng quan cập nhật"}),e.jsxs("div",{className:"grid grid-cols-6 gap-6",children:[e.jsxs("div",{className:"col-span-4 sm:col-span-3",children:[e.jsx("label",{htmlFor:"product_variant",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"***"}),e.jsx(o,{control:m,name:"name",render:({field:t})=>e.jsx("input",{type:"text",...t,disabled:!0,className:"bg-gray-50 border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"})})]}),e.jsxs("div",{className:"col-span-4 sm:col-span-3",children:[e.jsx("label",{htmlFor:"end_time",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Giờ kết thúc"}),e.jsx(o,{control:m,name:"endTime",render:({field:t})=>e.jsx("input",{type:"datetime-local",...t,onChange:r=>{b(!!r.target.value),t.onChange(r)},className:"bg-gray-50 border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"})}),i.endTime&&e.jsx("p",{className:"text-red-500 text-sm",children:i.endTime.message})]}),y&&e.jsxs("div",{className:"col-span-4 sm:col-span-3",children:[e.jsx("label",{htmlFor:"endTimeBid",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Giờ kết thúc dự phòng"}),e.jsx(o,{control:m,name:"endTimeBid",render:({field:t})=>e.jsx("input",{type:"datetime-local",...t,className:"bg-gray-50 border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"})}),i.endTimeBid&&e.jsx("p",{className:"text-red-500 text-sm",children:i.endTimeBid.message})]})]}),e.jsx("br",{}),e.jsx("div",{className:"col-span-6 sm:col-full",children:e.jsx("button",{type:"submit",className:"text-white bg-blue-600 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800",children:"Cập nhật"})})]})})})]})},z=()=>e.jsx($,{});export{z as default};
